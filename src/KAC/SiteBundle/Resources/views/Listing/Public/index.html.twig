{% extends 'KACSiteBundle:Listing:index.html.twig' %}

{% block header %}
    {{ parent() }}
    {% if is_granted('ROLE_ADMIN') %}
        <a href="{#{{ path('admin_'~app.request.get('_route'), (app.request.query.all?app.request.get('_route_params')|merge(app.request.query.all):app.request.get('_route_params'))) }}#}" class="fr button">Admin Mode</a>
    {% endif %}
    <div class="clear"></div>
{% endblock %}

{% block product_block %}
    <div itemscope itemtype="http://schema.org/Product" class="product relative" data-product-id="{{ product.id }}" id="product-{{ product.id }}">
        <a href="{{ path('page_request', {'url': product.url}) }}"><img class="fl product-image" itemprop="image" src="{{ asset(product.thumbnail_path) }}" border="0" alt="{{ product.header|raw }}" width="150" height="150"></a>
        {% if product.brand_logo != '' %}
            <a href="{{ path('page_request', {'url': product.brand_logo}) }}"><img class="fr brand-logo-image" src="{{ asset(product.brand_logo) }}" border="0" alt="{{ product.brand|raw }}" width="48" height="23"></a>
        {% endif %}
        <div>
            <h4><a itemprop="name" href="{{ path('page_request', {'url': product.url}) }}">{{ product.header|raw }}</a></h4>
            <div class="product-options">
                {% block product_prices %}
                    <div itemprop="offers" itemscope itemtype="http://schema.org/Offer">
                        <p class="ar product-price">
                            {% spaceless %}
                                {% if product.hide_price == 0 %}
                                    {% if product.url != '' %}
                                        <a href="{{ path('page_request', {'url': url}) }}">
                                    {% endif %}
                                    {% if product.low_price == product.high_price %}
                                        <span itemprop="price">&pound;{{ product.low_price|number_format(2) }}</span>
                                    {% else %}
                                        <span itemprop="price">&pound;{{ product.low_price|number_format(2) }}</span>
                                        <em> - </em>
                                        <span itemprop="price">&pound;{{ product.high_price|number_format(2) }}</span>
                                    {% endif %}
                                    {% if product.url != '' %}
                                        </a>
                                    {% endif %}
                                    <span class="product-tax"> (inc. VAT)</span>
                                {% else %}
                                    <a itemprop="price" href="{#{{ path('content_contact_us') }}#}">CONTACT US</a>
                                {% endif %}
                            {% endspaceless %}
                        </p>
                    </div>
                {% endblock %}

                {% block product_options %}

                {% endblock %}

                {% block product_features %}

                {% endblock %}

                {% block product_controls %}
                    <a href="{{ path('page_request', {'url': product.url}) }}" class="fr button button-blue button-small margin-bottom-5">More Info</a>
                    <div class="buy-now">
                        {% if product.available_for_purchase and not product.hide_price %}
                            <table class="fr no-padding no-border" align="right" cellpadding="0" cellspacing="0" border="0">
                                <tr>
                                    {% if product.product_code == '' %}
                                        <td class="out-of-stock">Out of Stock Until Further Notice</td>
                                    {% else %}
                                        <td class="no-padding no-border">
                                            <input id="quantity-{{ product.id }}" data-product-id="{{ product.id }}" class="ui-corner-none ui-corner-left number quantity" width="20" type="text" value="1" />
                                        </td>
                                        <td class="no-padding no-border">
                                            <div class="quantity-buttons-container no-padding">
                                                <div class="ui-corner-none ui-corner-tr action-increase-quantity" data-quantity-object="quantity-{{ product.id }}">+</div>
                                                <div class="ui-corner-none ui-corner-br action-decrease-quantity" data-quantity-object="quantity-{{ product.id }}">-</div>
                                            </div>
                                        </td>
                                        <td>
                                            <button data-product-id="{{ product.id }}" class="action-add-to-basket button margin-left-5 button-green">Add to Basket</button>
                                        </td>
                                    {% endif %}
                                </tr>
                            </table>
                            <input type="hidden" value="" id="selected-options-{{ product.id }}">
                        {% else %}
                            <a href="{#{{ path('content_contact_us') }}#}" class="fr button button-green">Contact Us to Buy</a>
                        {% endif %}
                    </div>
                {% endblock %}
            </div>

            {% block product_description %}
                <div class="product-information">
                    {{ product.description|raw }}
                </div>
            {% endblock %}

            {% block product_misc %}
                {% if '|1034|1122|69|' in product.department_ids %}
                    <div class="small-floating-offer small-floating-offer-top-left">
                        <p class="small-floating-offer-title">40% OFF</p>
                        <p class="small-floating-offer-description">Stellar<br />Pans</p>
                    </div>
                {% endif %}
                {% if product.brand_id == '7' %}
                    <div class="medium-floating-offer medium-floating-offer-bottom-left">
                        <p class="medium-floating-offer-title">10% OFF</p>
                        <p class="medium-floating-offer-description">When you buy 3 or more CDA items</p>
                    </div>
                {% endif %}
            {% endblock %}
            <div class="clear"></div>
        </div>
        <div class="clear"></div>
    </div>
{% endblock %}


