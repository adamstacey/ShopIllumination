{# Forms #}
{% extends 'KACSiteBundle::base.html.twig' %}

{% block title %}Orders | {{ parent() }}{% endblock %}

{% block header %}
    <header>
        {{ parent() }}
        <h1>Orders</h1>
    </header>
{% endblock %}
{% block body %}
    <section>
        <div class="widget-group clearfix">
            <div class="widget widget-1-of-1">

            </div>
        </div>
        <fieldset class="pbm">
            <table class="data-table treetable" id="departments">
                <tr>
                    {# sorting of properties based on query components #}
                    <th{% if pagination.isSorted('o.id') %} class="sorted"{% endif %}>{{ knp_pagination_sortable(pagination, '#', 'o.id') }}</th>
                    <th colspan="2"{% if pagination.isSorted('o.total') %} class="sorted"{% endif %}>{{ knp_pagination_sortable(pagination, 'Total', 'o.total') }}</th>
                    <th{% if pagination.isSorted('o.lastName') %} class="sorted"{% endif %}>{{ knp_pagination_sortable(pagination, 'Customer', 'o.firstName,o.lastName') }}</th>
                    <th{% if pagination.isSorted('o.createdAt') %} class="sorted"{% endif %}>{{ knp_pagination_sortable(pagination, 'Date', 'o.createdAt') }}</th>
                    <th{% if pagination.isSorted('o.status') %} class="sorted"{% endif %}>{{ knp_pagination_sortable(pagination, 'Status', 'o.status') }}</th>
                    <th></th>
                </tr>

                {# table body #}
                {% for order in pagination %}
                    <tr class="{{ cycle(['odd', 'even'], loop.index0) }}">
                        <td><a href="{{ path('orders_view', {'id': order.id}) }}">{{ order.id }}</a></td>
                        <td>{{ order.total }}</td>
                        <td>
                            {% if order.paymentType == '' %}
                                &nbsp;-&nbsp;
                            {% else %}
                                <img width="50" class="no-border" src="{{ asset(order.paymentTypeLogo) }}" border="0" alt="{{ order.paymentType }}" />
                            {% endif %}
                        </td>
                        <td>{{ order.firstName }} {{ order.lastName }}</td>
                        <td>{{ order.createdAt|date("d/m/Y h:iA") }}</td>
                        <td>
                            <select name="status[{{ order.id }}]" id="listing-status-{{ order.id }}" data-id="{{ order.id }}" class="listing-status full">
                                <option{% if order.status == 'Open Payment' %} selected="selected"{% endif %} value="Open Payment">Open Payment</option>
                                <option{% if order.status == 'Payment Failed' %} selected="selected"{% endif %} value="Payment Failed">Payment Failed</option>
                                <option{% if order.status == 'Cancelled' %} selected="selected"{% endif %} value="Cancelled">Cancelled</option>
                                <option{% if order.status == 'Payment Received' %} selected="selected"{% endif %} value="Payment Received">Payment Received</option>
                                <option{% if order.status == 'Processing Your Order' %} selected="selected"{% endif %} value="Processing Your Order">Processing Your Order</option>
                                <option{% if order.status == 'Back Ordered' %} selected="selected"{% endif %} value="Back Ordered">Back Ordered</option>
                                <option{% if order.status == 'Part Delivered' %} selected="selected"{% endif %} value="Part Delivered">Part Delivered</option>
                                <option{% if order.status == 'Order Ready for Collection' %} selected="selected"{% endif %} value="Order Ready for Collection">Order Ready for Collection</option>
                                <option{% if order.status == 'Order with Delivery Company' %} selected="selected"{% endif %} value="Order with Delivery Company">Order with Delivery Company</option>
                                <option{% if order.status == 'Order Completed' %} selected="selected"{% endif %} value="Order Completed">Order Completed</option>
                            </select>
                        </td>
                        <td width="1" class="buttons-container ac no-wrap">
                            {#<a data-id="{{ order.id }}" href="/uploads/documents/order/order-{{ order.id }}.pdf" target="_blank" class="button icon-set-white ui-button-{{ (order.orderPrinted == 1?'green':'red') }} action-print-order ui-corner-right tooltip-preview-right" data-icon-primary="ui-icon-document" data-icon-only="true" data-tooltip-id="#tooltip-documents-{{ order.id }}" data-ajax-path="{{ path('admin_orders_ajax_get_documents') }}" data-id="{{ order.id }}">Order</a>#}
                            {#<a{% if (order.trackingNumber != '') and (order.courier != '') %} target="_blank"{% endif %} href="{{ path('admin_'~data.settings.multiplePath~'_update_delivery', {'id': order.id}) }}" class="button icon-set-white ui-button-{% if order.deliveryType == 'Collection' %}red{% elseif order.deliveryCharge == 0 %}green{% else %}black{% endif %} ui-corner-none tooltip-preview-right" data-icon-primary="ui-icon-delivery-truck" data-icon-only="true" data-tooltip-id="#tooltip-delivery-information-{{ order.id }}" data-ajax-path="{{ path('admin_orders_ajax_get_delivery_information') }}" data-id="{{ order.id }}">Delivery Information</a>#}
                            {#<a href="{{ path('admin_'~data.settings.multiplePath~'_update_payment', {'id': order.id}) }}" class="button icon-set-white ui-button-{% if order.paymentType == '' %}red{% else %}{{ order.paymentResponseFraudColour }}{% endif %} ui-corner-none tooltip-preview-right" data-icon-primary="ui-icon-credit-card-back" data-icon-only="true" data-tooltip-id="#tooltip-payment-information-{{ order.id }}" data-ajax-path="{{ path('admin_orders_ajax_get_payment_information') }}" data-id="{{ order.id }}">Payment Information</a>#}
                            {#<a href="{{ path('admin_'~data.settings.multiplePath~'_update_notes', {'id': order.id}) }}" class="button tooltip-preview-right icon-set-white ui-button-black ui-corner-none" data-icon-primary="ui-icon-written-speech-bubble" data-icon-only="true"{% if order.notesCount > 0 %} data-notification="{{ order.notesCount }}" data-tooltip-id="#tooltip-notes-{{ order.id }}" data-ajax-path="{{ path('admin_orders_ajax_get_notes') }}" data-id="{{ order.id }}"{% endif %}>Customer Notes</a>#}
                            {#<a href="{{ path('admin_'~data.settings.multiplePath~'_update_products', {'id': order.id}) }}" class="button icon-set-white ui-button-black ui-corner-none tooltip-preview-right" data-icon-primary="ui-icon-shopping-basket" data-icon-only="true" data-notification="{{ order.items }}" data-tooltip-id="#tooltip-products-{{ order.id }}" data-ajax-path="{{ path('admin_orders_ajax_get_products') }}" data-id="{{ order.id }}">Shopping Basket</a>#}
                            {#<a href="{{ path('admin_'~data.settings.multiplePath~'_update_delivery', {'id': order.id}) }}" class="button icon-set-white ui-button-black ui-corner-left" data-icon-primary="ui-icon-pencil" data-icon-only="true">Edit</a>#}
                        </td>
                    </tr>
                {% endfor %}
            </table>
        </fieldset>
    </section>
{% endblock %}