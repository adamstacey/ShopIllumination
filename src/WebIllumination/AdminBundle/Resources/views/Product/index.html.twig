{% extends '::admin.html.twig' %}
{% block title %}Products | {{ parent() }}{% endblock %}
{% block leftmenu %}
	{{ parent() }}
	{% include 'WebIlluminationAdminBundle:Product:leftMenu.html.twig' %}
{% endblock %}
{% block header %}
	{{ parent() }}
	<div class="quick-search-container fr">
		<span>Quick Search</span>
		<input type="text" id="form-quick-search" value="" />
		<button id="quick-search-button" class="button small ui-button-blue action-quick-search" data-icon-primary="ui-icon-search">Search</button>
	</div>
	<h2>Products</h2>
{% endblock %}
{% block body %}
    <section class="container_6 clearfix no-padding-top">
    	<div class="grid_6">
    		<div id="confirm-multiple-delete" class="ui-helper-hidden ui-widget following message confirmation-message no-margin no-padding">
			    <div class="ui-state-highlight ui-corner-all no-margin no-padding">
			    	<div class="fl no-margin no-padding">
			    		<span class="ui-icon ui-icon-help"></span>
			    		<p class="small-message"><strong>WARNING:</strong> Are you sure you want to delete the selected products below?</p>
			    	</div>
			        <div class="fr no-margin no-padding">
			        	<a href="Javascript:void(0);" class="fl button ui-corner-none ui-corner-tl ui-corner-bl ui-button-blue action-cancel-multiple-delete">Cancel</a>
			        	<a href="Javascript:void(0);" class="fl button ui-corner-none ui-corner-tr ui-corner-br ui-button-red action-multiple-delete" data-icon-primary="ui-icon-closethick">Confirm Delete</a>
			        </div>
			        <div class="clear"></div>
			    </div>
			</div>
    		<div class="portlet">
				<header>
					<button id="filter-button" class="button ui-button-blue fr action-show-hide-filter" data-icon-primary="ui-icon-triangle-1-s">Filter Results</button>
	                <h2 id="listing-count"><img src="{{ asset('bundles/webilluminationadmin/images/loaders/ajax-bars-loader.gif') }}" border="0" alt="Loading" />Loading&hellip;</h2>
	            </header>
                <section class="no-padding">
                    <form id="form-filter" class="form has-validation" method="GET">
                        {#{% include 'WebIlluminationAdminBundle:Product:listingFilter.html.twig' with {'settings': settings, 'filters': filters, 'data': data} %}#}
                        {% include 'WebIlluminationAdminBundle:Product:listingSettings.html.twig' with {'settings': settings, 'data': data} %}
                        <div class="ac">
                            <button class="button bottom-button ui-button-green action-update-results" data-icon-primary="ui-icon-refresh">Update Your Results</button>
                            <button class="button bottom-button ui-button-red action-clear-filters" data-icon-primary="ui-icon-closethick">Clear Filters</button>
                        </div>
                    </form>
                    <div id="listing-pagination-top" class="listing-pagination ui-helper-hidden">
                        {{ pagination.render()|raw }}
                    </div>
                    <div class="clear"></div>
                    <div id="listing" class="ui-helper-hidden">
                        {% if pagination|length > 0 %}
                            <table class="data-table" id="data" width="100%">
                                <thead>
                                <tr>
                                    <th width="19" class="ac"><input type="checkbox" class="action-select-all" value="1" /></th>
                                    <th class="al" colspan="2">Product</th>
                                    <th class="ac">Code</th>
                                    <th class="ac">Brand</th>
                                    <th class="ac">Price</th>
                                    <th class="ac">Status</th>
                                    <th class="ac">&nbsp;</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for item in pagination %}
                                    <tr class="item {{ item.statusColour }}" id="item-{{ item.productId }}">
                                        <td width="19" class="ac select"><input data-id="{{ item.productId }}" type="checkbox" class="action-select" id="listing-select-{{ item.productId }}" value="1" /></td>
                                        <td width="50" class="al small white"><a href="{{ path('admin_products_update', {'id': item.productId}) }}"><img src="{{ asset(item.thumbnailPath) }}" border="0" alt="{{ item.header }}" width="50" height="50"></a></td>
                                        <td class="al small"><a href="{{ path('admin_products_update', {'id': item.productId}) }}" data-id="{{ item.productId }}">{{ item.header }}</a><br /><span class="small">{{ item.departmentPaths|replace({' |': '<br />', '|': '<br />'})|raw }}</span></td>
                                        <td class="ac small">{{ item.productCode }}</td>
                                        <td class="ac small">{{ item.brand.name }}</td>
                                        <td class="ac small no-wrap">{% spaceless %}
                                                {% if item.recommendedRetailPrice > item.listPrice %}
                                                    <span class="small strikethrough">&pound;{{ item.recommendedRetailPrice|number_format(2) }}</span><br /><span class="small">(-&pound;{{ item.savings|number_format(2) }})</span><br />
                                                {% endif %}
                                                &pound;{{ item.listPrice|number_format(2) }}
                                            {% endspaceless %}</td>
                                        <td width="85" class="ac small {{ item.statusColour }}">
                                            <select id="listing-status-{{ item.productId }}" data-id="{{ item.productId }}" class="listing-status full">
                                                <option{% if item.status == 'a' %} selected="selected"{% endif %} value="a">Active</option>
                                                <option{% if item.status == 'h' %} selected="selected"{% endif %} value="h">Hidden</option>
                                                <option{% if item.status == 'd' %} selected="selected"{% endif %} value="d">Disabled</option>
                                            </select>
                                        </td>
                                        <td width="1" class="buttons-container ac no-wrap">
                                            <img id="buttons-spacer" src="{{ asset('bundles/webilluminationadmin/images/blank.gif') }}" border="0" width="0" height="0" alt="" />
                                            <div class="clear"></div>
                                            <button data-id="{{ item.productId }}" class="ui-corner-none ui-corner-tr ui-corner-br button ui-button-red action-confirm-delete" data-icon-primary="ui-icon-closethick" data-icon-only="true">Delete</button>
                                            <a href="{{ path('admin_products_update', {'id': item.productId}) }}" class="ui-corner-none ui-corner-tl ui-corner-bl button" data-icon-primary="ui-icon-pencil" data-icon-only="true">Update</a>
                                        </td>
                                    </tr>
                                    <tr class="ui-helper-hidden more-information" id="more-information-{{ item.productId }}">
                                        <td colspan="9" class="no-padding">
                                            <div class="more-information-container no-padding-top">
                                                <button class="action-close-more-information button ui-button-red ui-corner-none ui-corner-bl ui-corner-br fr" data-icon-primary="ui-icon-closethick" data-icon-only="true">Close</button>
                                                {% include 'WebIlluminationAdminBundle:Product:listingConfirmDelete.html.twig' with {'settings': settings, 'item': item} %}
                                            </div>
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                            <script type="text/javascript">
                                $(document).ready(function() {
                                    {# Initialise Unifrom #}
                                    initialiseUniform("data");

                                    {# Set the widths of the action buttons #}
                                    var $actionButtonsWidth = 0;
                                    $("td.buttons-container:eq(0) .button").each(function() {
                                        $actionButtonsWidth = $actionButtonsWidth + $(this).outerWidth(true) + 2;
                                    });
                                    $("#buttons-spacer").width($actionButtonsWidth).attr("width", $actionButtonsWidth);
                                });
                            </script>
                        {% else %}
                            <p class="ac">Sorry, no results were found.</p>
                        {% endif %}
                    </div>
                    <div class="clear"></div>
                    <div id="listing-pagination-bottom" class="listing-pagination ui-helper-hidden">
                        {{ pagination.render()|raw }}
                    </div>
                    <div class="clear"></div>
                    {% include 'WebIlluminationAdminBundle:Product:listingToolbar.html.twig' with {'data': data} %}
                </section>
	        </div>
		</div>
	</section>
{% endblock %}
{% block javascripts %}
	{{ parent() }}
	{#{% include 'WebIlluminationAdminBundle:Product:indexScript.js.twig' with {'settings': settings, 'data': data} %}#}
{% endblock %}