{# Check if all data has loaded #}
function checkDataLoaded()
{
	if ($imagesLoaded && $pricesLoaded && $optionsLoaded && $filesLoaded && $relatedProductsLoaded && $cheaperAlternativesLoaded && $guaranteesLoaded && $redirectsLoaded)
	{
		updateStatus();
	}
}

{# Update the status #}
function updateStatus()
{
	{# General tab #}
	$("#form-status, #tab-general").removeClass("ui-state-success ui-state-highlight ui-state-error");
	if ($("#form-status-a").is(":checked"))
	{
		$("#form-status, #tab-general").addClass("ui-state-success");
	} else if ($("#form-status-h").is(":checked")) {
		$("#form-status, #tab-general").addClass("ui-state-highlight");
	} else {
		$("#form-status, #tab-general").addClass("ui-state-error");
	}
	
	{# Description tab #}
	$("#tab-description").removeClass("ui-state-success ui-state-highlight ui-state-error");
	if ($("#form-description").val() == "")
	{
		$("#tab-description").addClass("ui-state-error");
	} else if ($("#form-short-description").val() == "") {
		$("#tab-description").addClass("ui-state-highlight");
	} else {
		$("#tab-description").addClass("ui-state-success");
	}
	
	{# Images tab #}
	$("#tab-images").removeClass("ui-state-success ui-state-highlight ui-state-error");
	var $numberOfImages = $("#images .image-container img.action-image-popup").length;
	if ($numberOfImages == 1)
	{
		$("#tab-images").addClass("ui-state-highlight");
	} else if ($numberOfImages > 1) {
		$("#tab-images").addClass("ui-state-success");
	} else {
		$("#tab-images").addClass("ui-state-error");
	}
	
	{# Prices tab #}
	$("#tab-prices").removeClass("ui-state-success ui-state-highlight ui-state-error");
	var $numberOfPrices = $("#prices .price-container .price-id[value!='0']").length;
	if ($numberOfPrices > 0) {
		$("#tab-prices").addClass("ui-state-success");
	} else {
		$("#tab-prices").addClass("ui-state-error");
	}
	
	{# Options tab #}
	$("#tab-options").removeClass("ui-state-success ui-state-highlight ui-state-error");
	var $numberOfOptions = $("#options .product-option-group-container").length;
	if ($numberOfOptions > 0) {
		$("#tab-options").addClass("ui-state-success");
	} else {
		$("#tab-options").addClass("ui-state-highlight");
	}
	
	{# Features tab #}
	$("#tab-features").removeClass("ui-state-success ui-state-highlight ui-state-error");
	var $numberOfFeatures = $("#features .product-feature-group-container").length;
	if ($numberOfFeatures > 0) {
		$("#tab-features").addClass("ui-state-success");
	} else {
		$("#tab-features").addClass("ui-state-highlight");
	}
	
	{# Related Products tab #}
	$("#tab-related-products").removeClass("ui-state-success ui-state-highlight ui-state-error");
	var $numberOfRelatedProducts = $("#related-products .related-product-container .related-product-id[value!='0']").length;
	if ($numberOfRelatedProducts > 0) {
		$("#tab-related-products").addClass("ui-state-success");
	} else {
		$("#tab-related-products").addClass("ui-state-highlight");
	}
	
	{# Cheaper alternatives tab #}
	$("#tab-cheaper-alternatives").removeClass("ui-state-success ui-state-highlight ui-state-error");
	var $numberOfCheaperAlternatives = $("#cheaper-alternatives .cheaper-alternative-container .cheaper-alternative-id[value!='0']").length;
	if ($numberOfCheaperAlternatives > 0) {
		$("#tab-cheaper-alternatives").addClass("ui-state-success");
	} else {
		$("#tab-cheaper-alternatives").addClass("ui-state-highlight");
	}
	
	{# Features tab #}
	$("#tab-features").removeClass("ui-state-success ui-state-highlight ui-state-error");
	var $numberOfFeatures = $("#features .product-feature-group-container").length;
	if ($numberOfFeatures > 0) {
		$("#tab-features").addClass("ui-state-success");
	} else {
		$("#tab-features").addClass("ui-state-highlight");
	}
	
	{# Unique Product Identifiers tab #}
	$("#tab-unique-product-identifiers").removeClass("ui-state-success ui-state-highlight ui-state-error");
	if (($("#form-mpn").val() == "") && ($("#form-ean").val() == "") && ($("#form-upc").val() == "") && ($("#form-jan").val() == "") && ($("#form-isbn").val() == "")) {
		$("#tab-unique-product-identifiers").addClass("ui-state-highlight");
	} else {
		$("#tab-unique-product-identifiers").addClass("ui-state-success");
	}

	{# Files tab #}
	$("#tab-files").removeClass("ui-state-success ui-state-highlight ui-state-error");
	var $numberOfFiles = $("#files .file-container .file-id[value!='0']").length;
	if ($numberOfFiles > 0) {
		$("#tab-files").addClass("ui-state-success");
	} else {
		$("#tab-files").addClass("ui-state-highlight");
	}
	
	{# Package Dimensions tab #}
	$("#tab-package-dimensions").removeClass("ui-state-success ui-state-highlight ui-state-error");
	if (($("#form-weight").val() <= 0) && ($("#form-length").val() <= 0) && ($("#form-width").val() <= 0) && ($("#form-height").val() <= 0))
	{
		$("#tab-package-dimensions").addClass("ui-state-highlight");
	} else {
		$("#tab-package-dimensions").addClass("ui-state-success");
	}
	
	{# SEO tab #}
	$("#tab-seo").removeClass("ui-state-success ui-state-highlight ui-state-error");
	if (($("#form-url").val() == "") || ($("#form-page-title").val() == "") || ($("#form-header").val() == "") || ($("#form-meta-description").val() == "") || ($("#form-meta-keywords").val() == "") || ($("#form-search-words").val() == "") || ($("#form-alternative-product-codes").val() == ""))
	{ 
		$("#tab-seo").addClass("ui-state-error");
	} else {
		$("#tab-seo").addClass("ui-state-success");
	}
	
	{# Guarantees tab #}
	$("#tab-guarantees").removeClass("ui-state-success ui-state-highlight ui-state-error");
	var $numberOfGuarantees = $("#guarantees .guarantee-container .guarantee-id[value!='0']").length;
	if ($numberOfGuarantees > 0) {
		$("#tab-guarantees").addClass("ui-state-success");
	} else {
		$("#tab-guarantees").addClass("ui-state-highlight");
	}
	
	{# Redirects tab #}
	$("#tab-redirects").removeClass("ui-state-success ui-state-highlight ui-state-error");
	$("#tab-redirects").addClass("ui-state-success");
}

{# Load notification message #}
function loadNotificationMessage($container, $message, $type)
{
	$("#"+$container+" .message-text").html($message);
	$("#"+$container).fadeIn();
	$("html, body").animate({scrollTop: $("#"+$container).offset().top - 50},'slow');
	$("#ajax_loading").hide();
}

{# Reset interactions #}
function resetInteractions()
{
	$("#flash_messages .message").hide();
	$(".form-error").hide();
	$("input, select, textarea").removeClass("invalid");
	$("#description-confirm-overwrite").hide();
	$("#ajax_loading").hide();
}

{# Finish interactions #}
function finishInteractions()
{
	$("#ajax_loading").hide();
	updateStatus();
}

{# Initialise Uniform for form items presented via AJAX #}
function initialiseUniform($objectId)
{
	$("#"+$objectId+" :checkbox:not(.no-uniform), #"+$objectId+" :radio:not(.no-uniform), #"+$objectId+" select:not(.no-uniform), #"+$objectId+" :file:not(.no-uniform)").uniform();
		$("#"+$objectId+" .button").each(function () {
        $(this).button({
        	icons: {
            	primary: $(this).attr('data-icon-primary')?$(this).attr('data-icon-primary'):null, 
                secondary: $(this).attr('data-icon-primary')?$(this).attr('data-icon-secondary'):null
            }, 
           	text: $(this).attr('data-icon-only') === 'true'?false:true
    	});
    	var $dataNotification = $(this).attr("data-notification");
    	if (($(this).attr("data-notification") != "") && ($(this).attr("data-notification") != undefined))
    	{
    		$(this).prepend('<div class="button-notification">'+$(this).attr("data-notification")+'</div>');
    	}
    });
    $("#"+$objectId+" .selector, #"+$objectId+" .uploader").addClass("full");
    $("#"+$objectId+" .message.closeable").prepend('<span class="message-close ui-icon ui-icon-circle-close"></span>').find('.message-close').click(function () {
    	$(this).parent().fadeOut();
    });
    
    return false;
}